
This folder contains the example of IETS spectrum calculation for epitaxial graphene on 4H-SiC substrate. The purpose of this example is to show how to calculate IETS spectrum for doped semiconductor substrate using specific electronic state with finite wavevector. We note that this example might need long computational time.

In epitaxial graphene on 4H-SiC, IETS spectra show strong spatial dependence: whether the STM tip placed above the graphene C atoms placed on interfacial Si atom with or without dangling bond changes the IETS spectrum within 50 mV range drastically.
For detail, please see
https://journals.aps.org/prb/abstract/10.1103/PhysRevB.96.155431

I. Explanation of each folder

mixps: examples for VCA calculation used in SiC substrate

C-99.5-N-0.5-position1:  input for the calculation of IETS spectrum at the C atoms placed on the Si atom without dangling bond.

C-99.5-N-0.5-position2:  input for the calculation of IETS spectrum at the C atoms placed on the Si atom with dangling bond.

II. Procedures for the calculation in C-99.5-N-0.5-position1 & C-99.5-N-0.5-position2

1. Structure optimization in CGrun 

2. Obtain force constant by using FCrun_XX_XX (Here we split the FCrun calculation to reduce the computational time)

3. Calculate the bulk electronic state of electrode in ELEC1 (SiC) and ELEC2 (gold chain)

4. Calculate the overlap of wavefunction with respect to the small translational motion for +x, -x, +y, -y, +z, -z direction in OSrun 

5. Calculate the phonon and electron-phonon interaction by using Phonons script.
One important point is that we estimate electron-phonon interaction using M-point electronic state, because the conduction band of SiC touches the Fermi level at M-point by setting --x and --y option.
The command to running the calculation is:

$ Phonons -c --FCfirst=46 --FClast=73 --EPHfirst=46 --EPHlast=73 --DeviceFirst=46 --DeviceLast=76 -i masses.txt -x 0.5 -y 0.5 PHrun-M
By this command, the calculation result stores to the directory named as PHrun-M

6. Running the transiesta two-terminal setup calculation in TSrun
(Note: transiesta run for this system, especially position1 case is difficult to converge. Using **.DM file obtained CGrun supports the convergence.)

7. Running Inelastica in TSrun
This calculation also uses the electronic state at M-point. Here we use the 2meV broadening. 

$ Inelastica -v 0.18 --DeviceFirst=46 --DeviceLast=76 -p ../PHrun-M/Output.nc -x 0.5 -y 0.5 -V 0.002 INrun-M-Vrms-2meV

The input files for FCrun and OSrun also can generated by "test-setup.py" script bundled in C-99.5-N-0.5-position1 and C-99.5-N-0.5-position2 directory.
The example of dI/dV calculation results are shown in dIdV-results directory. (The red curve in position1 case is broadened dI/dV)
